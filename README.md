# Flan
## Fully kinetic trace impurity following code to be run on top of a turbulent Gkeyll simulation. 

Flan is named after my dog, Flannery. It does not stand for anything. 

<img src="https://github.com/shawnzamperini/flan/blob/main/docs/flan_image.jpg" width="250">

The code can be considered an extension to [Gkeyll](https://gkeyll.readthedocs.io/en/latest/install.html). Typical usage Flan is to track a trace amount of impurities in a turublent background generated by Gkeyll. Gkeyll has to capability to include an arbitrary number of impurity species so that they can be self-consistently evolved with the background hydrogen/electron plasma, but there are some limitations and issues in doing this.

- Computationally Expensive. If one were interested in tungsten, then Gkeyll would need to include all 74 charge state of tungsten. This would very quickly create an intractably large simulation.
- Potential Inaccuracies. Using tungsten as an example again, the lower charge states can have relatively large gyro-radii in typical SOL conditions. These may be so large that the gyrokinetic ordering is invalid.
- Ongoing Development. Gkeyll is still in the process of adding additional impurities species to simulations.
- Computational Resources. Gkeyll is an extremely powerful code, and the most relevant simulations may require use of a supercomputer, which not everyone has access to. Flan is designed to run on laptops or a typical cluster, which most people have access to one or the other. If one can obtain a Gkeyll plasma background from elsewhere, they will not need to worry about computational resources.
- User Effort. Flan is relatively simple to use because its scope is narrow - to simulate a trace amount of impurities in a turbulent background plasma. The user decides where they start, and off they go.

## Installing Flan

### Dependencies

## Regression Cases

## Upcoming Changes

- Rewrite code in C++ to take advantage of parallel architecture
- Probably excessive, but add in GPU support to C++ version of code. May become useful in the future.
- Expand code to non-Cartesian geometries
