# Flan
## Fully kinetic Monte Carlo to follow trace amount of impurities in a turbulent plasma. 

Flan is named after my dog, Flannery. It does not stand for anything. 

<img src="https://github.com/shawnzamperini/flan/blob/main/docs/flan_image.jpg" width="250">

Typical usage is to track a trace amount of impurities in a turbulent background generated by [Gkeyll](https://gkeyll.readthedocs.io/en/latest/install.html). Flan follows impurities in a plasma in a fully kinetic, Monte Carlo sense and is built on first-principles.

- The particles are tracked according to Lorentz force using the energy conserving [Boris time stepping algorithm](https://www.particleincell.com/2011/vxb-rotation/):
    $$\vec{F}=m(\vec{E} + \vec{v} \times \vec{B})$$
- Particle ionization and recombination is tracked via coupling to ADAS
- The collision model is based on the publication: [Nanbu, K. Theory of cumulative small-angle collisions in plasmas. Phys. Rev. E 55, 4642â€“4652 (1997)](https://journals.aps.org/pre/abstract/10.1103/PhysRevE.55.4642). This is a fully general collision scheme for Monte Carlo applications valid in all plasma regimes (with the only approximation being the plasma is in thermal equlibrium when calculating the Coulomb logarithm, likely a relatively negligible effect).

A publication detailing Flan is anticipated in 2025. 

## Documentation

[Link to the ReadTheDocs](https://flannery.readthedocs.io/en/latest/index.html)

## Upcoming Changes

- Incorporate MPI to spread computation across multiple nodes (Funding requested)
- Investigate if GPUs can be used to speed up transport calculations (Funding requested)
- Couple to CGYRO or XGC (Funding requested)
- ~~Add time profiling~~ Merged to main 7/31/25
- ~~Upgrade to Nanbu collision model~~ Merged to main 7/23/25
- ~~Expand code to non-Cartesian geometries (e.g., tokamak coordinates)~~ Merged to main 5/30/25
